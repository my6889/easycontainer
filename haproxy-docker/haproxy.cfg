global
    log stdout format raw local0
    maxconn 4096

defaults
    log     global
    mode    tcp                 # TCP模式（四层转发）
    option  tcplog              # 记录TCP连接日志
    option  dontlognull         # 不记录空连接
    timeout connect 5000ms      # 连接超时
    timeout client  50000ms     # 客户端超时
    timeout server  50000ms     # 服务端超时

# --- 规则 1: MySQL ---
listen mysql_proxy
    bind 0.0.0.0:33060
    balance roundrobin
    server mysql_server 192.168.1.100:3306 check

# --- 规则 2: Redis ---
listen redis_proxy
    bind 0.0.0.0:16379
    balance roundrobin
    server redis_server 192.168.1.101:6379 check

# --- 规则 3: SSH ---
listen ssh_proxy
    bind 0.0.0.0:2222
    server ssh_server   192.168.1.102:22   check

# 可选：监控页面 (工作在 HTTP 模式以便浏览器访问)
listen stats
    bind 0.0.0.0:8404
    mode http
    stats enable
    stats uri /stats
    stats refresh 10s
    stats admin if LOCALHOST